<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Smart QR Generator</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

<style>
:root {
  --bg:#f5f7fb; --card:#fff; --text:#111; --muted:#6b7280; --primary:#2563eb;
}
[data-theme="dark"] {
  --bg:#0f172a; --card:#020617; --text:#f8fafc; --muted:#94a3b8; --primary:#3b82f6;
}

*{box-sizing:border-box;font-family:system-ui}
body{margin:0;background:var(--bg);color:var(--text);transition:.3s}
.container{max-width:420px;margin:auto;padding:16px}
.card{background:var(--card);border-radius:20px;padding:18px;box-shadow:0 15px 35px rgba(0,0,0,.12);margin-bottom:16px}
h1{text-align:center;margin:4px 0 14px}

.toggle-bar{display:flex;background:#e5e7eb;border-radius:14px;overflow:hidden}
.toggle-bar button{flex:1;padding:12px;border:none;background:transparent;font-weight:600}
.toggle-bar .active{background:var(--primary);color:#fff}

label{font-size:13px;color:var(--muted);margin-top:14px;display:block}
input,textarea{width:100%;padding:12px;border-radius:14px;border:1px solid #cbd5f5;margin-top:6px;background:transparent;color:inherit}
textarea{resize:none}

.row{display:flex;gap:10px;margin-top:12px}
button.primary{background:var(--primary);color:#fff;border:none;padding:14px;border-radius:16px;font-size:16px;font-weight:600;width:100%}
button.secondary{background:#e5e7eb;border:none;padding:12px;border-radius:14px;flex:1}

.hidden{display:none}
#qrWrap{display:flex;justify-content:center;margin-top:18px}
canvas{border-radius:18px}

.switch{display:flex;justify-content:space-between;align-items:center;margin-top:14px}
.switch input{width:44px;height:24px}

.preview{font-size:13px;padding:10px;background:#0206170f;border-radius:10px;margin-top:8px;word-break:break-all}
.designs{display:flex;gap:10px;margin-top:10px}
.design{flex:1;padding:10px;border-radius:12px;text-align:center;border:2px solid transparent;background:#e5e7eb;font-size:13px}
.design.active{border-color:var(--primary)}

.color-box{display:flex;gap:10px;margin-top:10px}
</style>
</head>

<body>
<div class="container">

<div class="card">
<h1>QR Generator</h1>

<!-- MODE TOGGLER -->
<div class="toggle-bar">
  <button id="btnUrl" class="active" onclick="setMode('url')">URL</button>
  <button id="btnWa" onclick="setMode('wa')">WhatsApp</button>
</div>

<div id="urlBox">
  <label>Website URL</label>
  <input id="url" placeholder="https://instagram.com/..." />
</div>

<div id="waBox" class="hidden">
  <label>Phone</label>
  <input id="phone" placeholder="91XXXXXXXXXX" />
  <label>Message</label>
  <textarea id="msg" rows="2">Hello</textarea>
</div>

<!-- DESIGN -->
<label>QR Design</label>
<div class="designs">
  <div class="design active" onclick="setDesign(0)">Square</div>
  <div class="design" onclick="setDesign(1)">Rounded</div>
  <div class="design" onclick="setDesign(2)">Soft</div>
</div>

<!-- COLORS -->
<div class="switch">
  <span>Customize Colors</span>
  <input type="checkbox" onchange="toggleColors(this)">
</div>
<div id="colors" class="hidden color-box">
  <input type="color" id="fg" value="#000000">
  <input type="color" id="bg" value="#ffffff">
</div>

<!-- LOGO -->
<div class="switch">
  <span>Custom Logo</span>
  <input type="checkbox" onchange="toggleLogo(this)">
</div>
<input id="logo" type="file" accept="image/*" class="hidden">

<button class="primary" onclick="generate()">Generate QR</button>

<div id="qrWrap"></div>

<label>Preview URL</label>
<div class="preview" id="preview">â€”</div>

<div class="row">
  <button class="secondary" onclick="download()">Download</button>
  <button class="secondary" onclick="copy()">Copy</button>
</div>
</div>

<div class="card">
<div class="switch">
  <span>Dark Mode</span>
  <input type="checkbox" onchange="toggleTheme(this)">
</div>
</div>

</div>

<script>
let mode="url", design=0, current="";

const logos = {
  whatsapp:"https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg",
  instagram:"https://upload.wikimedia.org/wikipedia/commons/a/a5/Instagram_icon.png",
  facebook:"https://upload.wikimedia.org/wikipedia/commons/0/05/Facebook_Logo_%282019%29.png",
  twitter:"https://upload.wikimedia.org/wikipedia/commons/6/6f/Logo_of_Twitter.svg"
};

function setMode(m){
  mode=m;
  btnUrl.classList.toggle("active",m==="url");
  btnWa.classList.toggle("active",m==="wa");
  urlBox.classList.toggle("hidden",m!=="url");
  waBox.classList.toggle("hidden",m!=="wa");
}

function setDesign(i){
  design=i;
  document.querySelectorAll(".design").forEach((d,n)=>d.classList.toggle("active",n===i));
}

function toggleColors(e){colors.classList.toggle("hidden",!e.checked)}
function toggleLogo(e){logo.classList.toggle("hidden",!e.checked)}

function detectLogo(url){
  if(mode==="wa") return logos.whatsapp;
  if(url.includes("instagram")) return logos.instagram;
  if(url.includes("facebook")) return logos.facebook;
  if(url.includes("twitter")||url.includes("x.com")) return logos.twitter;
  return null;
}

function generate(){
  qrWrap.innerHTML="";
  current = mode==="url" ? url.value :
    `https://wa.me/${phone.value}?text=${encodeURIComponent(msg.value)}`;
  preview.textContent=current;

  new QRCode(qrWrap,{
    text:current,width:260,height:260,
    colorDark:fg.value,colorLight:bg.value,
    correctLevel:QRCode.CorrectLevel.H
  });

  setTimeout(drawLogo,300);
}

function drawLogo(){
  const canvas=document.querySelector("canvas");
  if(!canvas) return;
  const ctx=canvas.getContext("2d");
  let imgSrc=null;

  if(logo.files[0]) imgSrc=URL.createObjectURL(logo.files[0]);
  else imgSrc=detectLogo(current);
  if(!imgSrc) return;

  const img=new Image();
  img.onload=()=>{
    const s=canvas.width*0.22;
    ctx.drawImage(img,(canvas.width-s)/2,(canvas.height-s)/2,s,s);
  };
  img.src=imgSrc;
}

function download(){
  const c=document.querySelector("canvas");
  if(!c) return;
  const a=document.createElement("a");
  a.href=c.toDataURL();a.download="qr.png";a.click();
}
function copy(){navigator.clipboard.writeText(current)}

function toggleTheme(e){
  document.documentElement.dataset.theme=e.checked?"dark":"light";
  localStorage.setItem("theme",e.checked?"dark":"light");
}
if(localStorage.theme==="dark"){
  document.documentElement.dataset.theme="dark";
}
</script>
</body>
</html>
